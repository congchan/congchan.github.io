<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Python之奇技淫巧 | Cong's Log</title><meta name=keywords content="Python,Programming Language"><meta name=description content='FBI WARNING 这不是python入门

函数

Fundamentally, the qualities of good functions all reinforce the idea that functions are abstractions.
函数作为一种机制, 提供了用于抽象数值运算的模式, 使其独立于所涉及的特定值。
文档

code is written only once, but often read many times.
docstring
def pressure(v, t, n):
  """Compute the pressure in pascals of an ideal gas.

  Applies the ideal gas law: http://en.wikipedia.org/wiki/Ideal_gas_law

  v -- volume of gas, in cubic meters
  t -- absolute temperature in degrees kelvin
  n -- particles of gas
  """
>>> help(pressure)
Python docstring guidelines'><meta name=author content="Cong Chan"><link rel=canonical href=https://congchan.github.io/posts/python%E4%B9%8B%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7/><link crossorigin=anonymous href=/assets/css/stylesheet.1f908d890a7e84b56b73a7a0dc6591e6e3f782fcba048ce1eb46319195bedaef.css integrity="sha256-H5CNiQp+hLVrc6eg3GWR5uP3gvy6BIzh60YxkZW+2u8=" rel="preload stylesheet" as=style><link rel=icon href=https://congchan.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://congchan.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://congchan.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://congchan.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://congchan.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://congchan.github.io/posts/python%E4%B9%8B%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css integrity=sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js integrity=sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4 crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js integrity=sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa crossorigin=anonymous onload='renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"\\[",right:"\\]",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1}]})'></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-6T0DPR6SMC"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-6T0DPR6SMC")}</script><meta property="og:url" content="https://congchan.github.io/posts/python%E4%B9%8B%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7/"><meta property="og:site_name" content="Cong's Log"><meta property="og:title" content="Python之奇技淫巧"><meta property="og:description" content='FBI WARNING 这不是python入门
函数 Fundamentally, the qualities of good functions all reinforce the idea that functions are abstractions.
函数作为一种机制, 提供了用于抽象数值运算的模式, 使其独立于所涉及的特定值。
文档 code is written only once, but often read many times.
docstring
def pressure(v, t, n): """Compute the pressure in pascals of an ideal gas. Applies the ideal gas law: http://en.wikipedia.org/wiki/Ideal_gas_law v -- volume of gas, in cubic meters t -- absolute temperature in degrees kelvin n -- particles of gas """ >>> help(pressure) Python docstring guidelines'><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2017-02-22T00:00:00+00:00"><meta property="article:modified_time" content="2017-02-22T00:00:00+00:00"><meta property="article:tag" content="Python"><meta property="article:tag" content="Programming Language"><meta name=twitter:card content="summary"><meta name=twitter:title content="Python之奇技淫巧"><meta name=twitter:description content='FBI WARNING 这不是python入门

函数

Fundamentally, the qualities of good functions all reinforce the idea that functions are abstractions.
函数作为一种机制, 提供了用于抽象数值运算的模式, 使其独立于所涉及的特定值。
文档

code is written only once, but often read many times.
docstring
def pressure(v, t, n):
  """Compute the pressure in pascals of an ideal gas.

  Applies the ideal gas law: http://en.wikipedia.org/wiki/Ideal_gas_law

  v -- volume of gas, in cubic meters
  t -- absolute temperature in degrees kelvin
  n -- particles of gas
  """
>>> help(pressure)
Python docstring guidelines'><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://congchan.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Python之奇技淫巧","item":"https://congchan.github.io/posts/python%E4%B9%8B%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Python之奇技淫巧","name":"Python之奇技淫巧","description":"FBI WARNING 这不是python入门\n函数 Fundamentally, the qualities of good functions all reinforce the idea that functions are abstractions.\n函数作为一种机制, 提供了用于抽象数值运算的模式, 使其独立于所涉及的特定值。\n文档 code is written only once, but often read many times.\ndocstring\ndef pressure(v, t, n): \u0026#34;\u0026#34;\u0026#34;Compute the pressure in pascals of an ideal gas. Applies the ideal gas law: http://en.wikipedia.org/wiki/Ideal_gas_law v -- volume of gas, in cubic meters t -- absolute temperature in degrees kelvin n -- particles of gas \u0026#34;\u0026#34;\u0026#34; \u0026gt;\u0026gt;\u0026gt; help(pressure) Python docstring guidelines\n","keywords":["Python","Programming Language"],"articleBody":"FBI WARNING 这不是python入门\n函数 Fundamentally, the qualities of good functions all reinforce the idea that functions are abstractions.\n函数作为一种机制, 提供了用于抽象数值运算的模式, 使其独立于所涉及的特定值。\n文档 code is written only once, but often read many times.\ndocstring\ndef pressure(v, t, n): \"\"\"Compute the pressure in pascals of an ideal gas. Applies the ideal gas law: http://en.wikipedia.org/wiki/Ideal_gas_law v -- volume of gas, in cubic meters t -- absolute temperature in degrees kelvin n -- particles of gas \"\"\" \u003e\u003e\u003e help(pressure) Python docstring guidelines\n高阶函数 Functions that manipulate functions are called higher-order functions.\n高阶函数进一步扩展一般函数，能表达通用的, 独立于其调用的特定函数的计算方案。\nFunctions as Arguments def summation(n, term): total, k = 0, 1 while k \u003c= n: total, k = total + term(k), k + 1 return total def cube(x): return x*x*x def sum_cubes(n): return summation(n, cube) Nested Definitions One negative consequence of this approach is that the global frame becomes cluttered with names of small functions, which must all be unique. Another problem is that we are constrained by particular function signatures.\n当同一环境下，当出现需要相似功能但与已有函数的参数不同时，此时嵌套函数可以方便我们定义函数.\ndef improve(update, close, guess=1): while not close(guess): guess = update(guess) return guess 这里的update只接受一个参数, 假如我们刚好有需要两个参数的\ndef sqrt_update(x, a): \"\"\"square root\"\"\" return average(x, a/x) 这个函数就无法传入improve中.\n嵌套函数, 让sqrt_update传入参数保持一个, 同时额外能够获取其本地环境frame的其他参数\ndef sqrt(a): def sqrt_update(x): return average(x, a/x) def sqrt_close(x): return approx_eq(x * x, a) return improve(sqrt_update, sqrt_close) local def statements only affect the current local frame. lexical scoping: sharing names among nested definitions\nFunctions as Returned Values def compose1(f, g): def h(x): return f(g(x)) return h 比如TensorFlow中常用的\ndef model_fn_builder(...): \"\"\"Returns `model_fn` closure.\"\"\" def model_fn(features, labels, mode, params): # pylint: disable=unused-argument \"\"\"The actual `model_fn`.\"\"\" ... return ... return model_fn Currying 一种变换方式, 使用高阶函数将一个带有多个参数的函数转换为一个函数链，每个函数都接受一个参数。\ndef curried_pow(x): def h(y): return pow(x, y) return h \u003e\u003e\u003e curried_pow(2)(3) 8 Lambda Expressions 利用lambda表达式动态创建函数, 省去命名\nlambda x : f(g(x)) \"A function that takes x and returns f(g(x))\" lambda 来由\nIt may seem perverse to use lambda to introduce a procedure/function. The notation goes back to Alonzo Church, who in the 1930’s started with a “hat” symbol; he wrote the square function as “ŷ . y × y”. But frustrated typographers moved the hat to the left of the parameter and changed it to a capital lambda: “Λy . y × y”; from there the capital lambda was changed to lowercase, and now we see “λy . y × y” in math books and (lambda (y) (* y y)) in Lisp. —Peter Norvig (norvig.com/lispy2.html)\nFunction Decorators 装饰器也是一种高阶函数,\ndef trace(fn): def wrapped(x): print('-\u003e ', fn, '(', x, ')') return fn(x) return wrapped @trace def triple(x): return 3 * x 以上等价于\ntriple = trace(triple) \u003e\u003e\u003e triple(12) -\u003e ( 12 ) 36 ","wordCount":"421","inLanguage":"en","datePublished":"2017-02-22T00:00:00Z","dateModified":"2017-02-22T00:00:00Z","author":{"@type":"Person","name":"Cong Chan"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://congchan.github.io/posts/python%E4%B9%8B%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7/"},"publisher":{"@type":"Organization","name":"Cong's Log","logo":{"@type":"ImageObject","url":"https://congchan.github.io/favicons/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://congchan.github.io/ accesskey=h title="Cong's Log (Alt + H)">Cong's Log</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://congchan.github.io/archives title=Archive><span>Archive</span></a></li><li><a href=https://congchan.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://congchan.github.io/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://congchan.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://congchan.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Python之奇技淫巧</h1><div class=post-meta><span title='2017-02-22 00:00:00 +0000 UTC'>2017-02-22</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;Cong Chan&nbsp;|&nbsp;<a href=https://github.com/%3cgitlab%20user%3e/%3crepo%20name%3e/tree/%3cbranch%20name%3e/%3cpath%20to%20content%3e//posts/python-digest-cn.md rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e5%87%bd%e6%95%b0 aria-label=函数>函数</a><ul><li><a href=#%e6%96%87%e6%a1%a3 aria-label=文档>文档</a></li></ul></li><li><a href=#%e9%ab%98%e9%98%b6%e5%87%bd%e6%95%b0 aria-label=高阶函数>高阶函数</a><ul><li><a href=#functions-as-arguments aria-label="Functions as Arguments">Functions as Arguments</a></li><li><a href=#nested-definitions aria-label="Nested Definitions">Nested Definitions</a></li><li><a href=#functions-as-returned-values aria-label="Functions as Returned Values">Functions as Returned Values</a></li><li><a href=#currying aria-label=Currying>Currying</a></li><li><a href=#lambda-expressions aria-label="Lambda Expressions">Lambda Expressions</a></li><li><a href=#function-decorators aria-label="Function Decorators">Function Decorators</a></li></ul></li></ul></div></details></div><div class=post-content><p>FBI WARNING 这不是python入门</p><h2 id=函数>函数<a hidden class=anchor aria-hidden=true href=#函数>#</a></h2><blockquote><p>Fundamentally, the qualities of good functions all reinforce the idea that functions are <strong>abstractions</strong>.</p></blockquote><p>函数作为一种机制, 提供了用于抽象数值运算的模式, 使其独立于所涉及的特定值。</p><h3 id=文档>文档<a hidden class=anchor aria-hidden=true href=#文档>#</a></h3><blockquote><p>code is written only once, but often read many times.</p></blockquote><p>docstring</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>pressure</span><span class=p>(</span><span class=n>v</span><span class=p>,</span> <span class=n>t</span><span class=p>,</span> <span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;&#34;&#34;Compute the pressure in pascals of an ideal gas.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>  Applies the ideal gas law: http://en.wikipedia.org/wiki/Ideal_gas_law
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>  v -- volume of gas, in cubic meters
</span></span></span><span class=line><span class=cl><span class=s2>  t -- absolute temperature in degrees kelvin
</span></span></span><span class=line><span class=cl><span class=s2>  n -- particles of gas
</span></span></span><span class=line><span class=cl><span class=s2>  &#34;&#34;&#34;</span>
</span></span></code></pre></div><pre tabindex=0><code>&gt;&gt;&gt; help(pressure)
</code></pre><p><a href=http://www.python.org/dev/peps/pep-0257/>Python docstring guidelines</a></p><h2 id=高阶函数>高阶函数<a hidden class=anchor aria-hidden=true href=#高阶函数>#</a></h2><blockquote><p>Functions that manipulate functions are called higher-order functions.</p></blockquote><p>高阶函数进一步扩展一般函数，能表达通用的, 独立于其调用的特定函数的计算方案。</p><h3 id=functions-as-arguments>Functions as Arguments<a hidden class=anchor aria-hidden=true href=#functions-as-arguments>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>summation</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>term</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=n>total</span><span class=p>,</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>  <span class=k>while</span> <span class=n>k</span> <span class=o>&lt;=</span> <span class=n>n</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=n>total</span><span class=p>,</span> <span class=n>k</span> <span class=o>=</span> <span class=n>total</span> <span class=o>+</span> <span class=n>term</span><span class=p>(</span><span class=n>k</span><span class=p>),</span> <span class=n>k</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>total</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>cube</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=n>x</span><span class=o>*</span><span class=n>x</span><span class=o>*</span><span class=n>x</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>sum_cubes</span><span class=p>(</span><span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>summation</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>cube</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=nested-definitions>Nested Definitions<a hidden class=anchor aria-hidden=true href=#nested-definitions>#</a></h3><blockquote><p>One negative consequence of this approach is that the global frame becomes cluttered with names of small functions, which must all be unique. Another problem is that we are constrained by particular function signatures.</p></blockquote><p>当同一环境下，当出现需要相似功能但与已有函数的参数不同时，此时嵌套函数可以方便我们定义函数.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>improve</span><span class=p>(</span><span class=n>update</span><span class=p>,</span> <span class=n>close</span><span class=p>,</span> <span class=n>guess</span><span class=o>=</span><span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=k>while</span> <span class=ow>not</span> <span class=n>close</span><span class=p>(</span><span class=n>guess</span><span class=p>):</span>
</span></span><span class=line><span class=cl>      <span class=n>guess</span> <span class=o>=</span> <span class=n>update</span><span class=p>(</span><span class=n>guess</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>guess</span>
</span></span></code></pre></div><p>这里的<code>update</code>只接受一个参数, 假如我们刚好有需要两个参数的</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>sqrt_update</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>a</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;&#34;&#34;square root&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>average</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>a</span><span class=o>/</span><span class=n>x</span><span class=p>)</span>
</span></span></code></pre></div><p>这个函数就无法传入<code>improve</code>中.</p><p>嵌套函数, 让<code>sqrt_update</code>传入参数保持一个, 同时额外能够获取其本地环境frame的其他参数</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>sqrt</span><span class=p>(</span><span class=n>a</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=k>def</span> <span class=nf>sqrt_update</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=n>average</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>a</span><span class=o>/</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>def</span> <span class=nf>sqrt_close</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=n>approx_eq</span><span class=p>(</span><span class=n>x</span> <span class=o>*</span> <span class=n>x</span><span class=p>,</span> <span class=n>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>improve</span><span class=p>(</span><span class=n>sqrt_update</span><span class=p>,</span> <span class=n>sqrt_close</span><span class=p>)</span>
</span></span></code></pre></div><blockquote><p>local def statements only affect the current local frame.
<strong>lexical scoping</strong>: sharing names among nested definitions</p></blockquote><h3 id=functions-as-returned-values>Functions as Returned Values<a hidden class=anchor aria-hidden=true href=#functions-as-returned-values>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>compose1</span><span class=p>(</span><span class=n>f</span><span class=p>,</span> <span class=n>g</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=k>def</span> <span class=nf>h</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=n>f</span><span class=p>(</span><span class=n>g</span><span class=p>(</span><span class=n>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>h</span>
</span></span></code></pre></div><p>比如TensorFlow中常用的</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>model_fn_builder</span><span class=p>(</span><span class=o>...</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;&#34;&#34;Returns `model_fn` closure.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>  <span class=k>def</span> <span class=nf>model_fn</span><span class=p>(</span><span class=n>features</span><span class=p>,</span> <span class=n>labels</span><span class=p>,</span> <span class=n>mode</span><span class=p>,</span> <span class=n>params</span><span class=p>):</span>  <span class=c1># pylint: disable=unused-argument</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;The actual `model_fn`.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=o>...</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=o>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>model_fn</span>
</span></span></code></pre></div><h3 id=currying>Currying<a hidden class=anchor aria-hidden=true href=#currying>#</a></h3><p>一种变换方式, 使用高阶函数将一个带有多个参数的函数转换为一个函数链，每个函数都接受一个参数。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>curried_pow</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=k>def</span> <span class=nf>h</span><span class=p>(</span><span class=n>y</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>pow</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>h</span>
</span></span></code></pre></div><pre tabindex=0><code>&gt;&gt;&gt; curried_pow(2)(3)
8
</code></pre><h3 id=lambda-expressions>Lambda Expressions<a hidden class=anchor aria-hidden=true href=#lambda-expressions>#</a></h3><p>利用lambda表达式动态创建函数, 省去命名</p><pre tabindex=0><code>     lambda            x            :          f(g(x))
&#34;A function that    takes x    and returns     f(g(x))&#34;
</code></pre><p>lambda 来由</p><blockquote><p>It may seem perverse to use lambda to introduce a procedure/function. The notation goes back to Alonzo Church, who in the 1930&rsquo;s started with a &ldquo;hat&rdquo; symbol; he wrote the square function as &ldquo;ŷ . y × y&rdquo;. But frustrated typographers moved the hat to the left of the parameter and changed it to a capital lambda: &ldquo;Λy . y × y&rdquo;; from there the capital lambda was changed to lowercase, and now we see &ldquo;λy . y × y&rdquo; in math books and (lambda (y) (* y y)) in Lisp.
—Peter Norvig (norvig.com/lispy2.html)</p></blockquote><h3 id=function-decorators>Function Decorators<a hidden class=anchor aria-hidden=true href=#function-decorators>#</a></h3><p>装饰器也是一种高阶函数,</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>trace</span><span class=p>(</span><span class=n>fn</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=k>def</span> <span class=nf>wrapped</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;-&gt; &#39;</span><span class=p>,</span> <span class=n>fn</span><span class=p>,</span> <span class=s1>&#39;(&#39;</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=s1>&#39;)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>fn</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>wrapped</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@trace</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>triple</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>3</span> <span class=o>*</span> <span class=n>x</span>
</span></span></code></pre></div><p>以上等价于</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>triple</span> <span class=o>=</span> <span class=n>trace</span><span class=p>(</span><span class=n>triple</span><span class=p>)</span>
</span></span></code></pre></div><pre tabindex=0><code>&gt;&gt;&gt; triple(12)
-&gt;  &lt;function triple at 0x102a39848&gt; ( 12 )
36
</code></pre></div><footer class=post-footer><ul class=post-tags><li><a href=https://congchan.github.io/tags/python/>Python</a></li><li><a href=https://congchan.github.io/tags/programming-language/>Programming Language</a></li></ul><nav class=paginav><a class=prev href=https://congchan.github.io/posts/java-12-%E6%8E%A5%E5%8F%A3-interface/><span class=title>« Prev</span><br><span>Java 12 | 接口 Interface</span>
</a><a class=next href=https://congchan.github.io/posts/java-11-%E6%B5%8B%E8%AF%95-testing/><span class=title>Next »</span><br><span>Java 11 | 测试 Testing</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Python之奇技淫巧 on x" href="https://x.com/intent/tweet/?text=Python%e4%b9%8b%e5%a5%87%e6%8a%80%e6%b7%ab%e5%b7%a7&amp;url=https%3a%2f%2fcongchan.github.io%2fposts%2fpython%25E4%25B9%258B%25E5%25A5%2587%25E6%258A%2580%25E6%25B7%25AB%25E5%25B7%25A7%2f&amp;hashtags=Python%2cProgrammingLanguage"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Python之奇技淫巧 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fcongchan.github.io%2fposts%2fpython%25E4%25B9%258B%25E5%25A5%2587%25E6%258A%2580%25E6%25B7%25AB%25E5%25B7%25A7%2f&amp;title=Python%e4%b9%8b%e5%a5%87%e6%8a%80%e6%b7%ab%e5%b7%a7&amp;summary=Python%e4%b9%8b%e5%a5%87%e6%8a%80%e6%b7%ab%e5%b7%a7&amp;source=https%3a%2f%2fcongchan.github.io%2fposts%2fpython%25E4%25B9%258B%25E5%25A5%2587%25E6%258A%2580%25E6%25B7%25AB%25E5%25B7%25A7%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Python之奇技淫巧 on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fcongchan.github.io%2fposts%2fpython%25E4%25B9%258B%25E5%25A5%2587%25E6%258A%2580%25E6%25B7%25AB%25E5%25B7%25A7%2f&title=Python%e4%b9%8b%e5%a5%87%e6%8a%80%e6%b7%ab%e5%b7%a7"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Python之奇技淫巧 on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fcongchan.github.io%2fposts%2fpython%25E4%25B9%258B%25E5%25A5%2587%25E6%258A%2580%25E6%25B7%25AB%25E5%25B7%25A7%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Python之奇技淫巧 on whatsapp" href="https://api.whatsapp.com/send?text=Python%e4%b9%8b%e5%a5%87%e6%8a%80%e6%b7%ab%e5%b7%a7%20-%20https%3a%2f%2fcongchan.github.io%2fposts%2fpython%25E4%25B9%258B%25E5%25A5%2587%25E6%258A%2580%25E6%25B7%25AB%25E5%25B7%25A7%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Python之奇技淫巧 on telegram" href="https://telegram.me/share/url?text=Python%e4%b9%8b%e5%a5%87%e6%8a%80%e6%b7%ab%e5%b7%a7&amp;url=https%3a%2f%2fcongchan.github.io%2fposts%2fpython%25E4%25B9%258B%25E5%25A5%2587%25E6%258A%2580%25E6%25B7%25AB%25E5%25B7%25A7%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentColor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Python之奇技淫巧 on ycombinator" href="https://news.ycombinator.com/submitlink?t=Python%e4%b9%8b%e5%a5%87%e6%8a%80%e6%b7%ab%e5%b7%a7&u=https%3a%2f%2fcongchan.github.io%2fposts%2fpython%25E4%25B9%258B%25E5%25A5%2587%25E6%258A%2580%25E6%25B7%25AB%25E5%25B7%25A7%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://congchan.github.io/>Cong's Log</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>